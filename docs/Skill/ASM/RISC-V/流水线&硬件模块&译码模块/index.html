<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Skill/ASM/RISC-V/流水线&硬件模块&译码模块">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">流水线 &amp; 硬件模块 &amp; 译码模块 | Doongz&#x27;s Site</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://doongz.github.io/docs/Skill/ASM/RISC-V/流水线&amp;硬件模块&amp;译码模块"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="流水线 &amp; 硬件模块 &amp; 译码模块 | Doongz&#x27;s Site"><meta data-rh="true" name="description" content="来源"><meta data-rh="true" property="og:description" content="来源"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://doongz.github.io/docs/Skill/ASM/RISC-V/流水线&amp;硬件模块&amp;译码模块"><link data-rh="true" rel="alternate" href="https://doongz.github.io/docs/Skill/ASM/RISC-V/流水线&amp;硬件模块&amp;译码模块" hreflang="en"><link data-rh="true" rel="alternate" href="https://doongz.github.io/docs/Skill/ASM/RISC-V/流水线&amp;硬件模块&amp;译码模块" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Doongz&#39;s Site RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Doongz&#39;s Site Atom Feed">





<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.bbae31c2.css">
<link rel="preload" href="/assets/js/runtime~main.958a4673.js" as="script">
<link rel="preload" href="/assets/js/main.715bfe53.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Home page</b></a><a class="navbar__item navbar__link" href="/docs/catalogue-algo">Algorithm</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/catalogue-skill">Skill</a><a class="navbar__item navbar__link" href="/docs/catalogue-knowledge">Knowledge</a><a class="navbar__item navbar__link" href="/community/support">Community</a><a class="navbar__item navbar__link" href="/blog">Blog</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Courses</a><ul class="dropdown__menu"><li><a href="https://github.com/doongz/mlc-ai" target="_blank" rel="noopener noreferrer" class="dropdown__link">Machine Learning Compilation<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/doongz/cs229" target="_blank" rel="noopener noreferrer" class="dropdown__link">Stanford CS229: Machine Learning<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/doongz/aics" target="_blank" rel="noopener noreferrer" class="dropdown__link">中国科学院 智能计算系统<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/doongz/cs50-ai" target="_blank" rel="noopener noreferrer" class="dropdown__link">Harvard CS50’s Introduction to AI with Python<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/doongz/mit-6.824" target="_blank" rel="noopener noreferrer" class="dropdown__link">MIT-6.824 Distributed Systems<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/doongz/os-workbench" target="_blank" rel="noopener noreferrer" class="dropdown__link">南京大学 操作系统：设计与实现<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/doongz/mit-6.s081" target="_blank" rel="noopener noreferrer" class="dropdown__link">MIT-6.S081 Operating Systems Engineering<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://github.com/doongz" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/catalogue-skill">Catalogue</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/Skill/ASM/RISC-V/汇编语言格式及ABI">ASM</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/Skill/ASM/RISC-V/汇编语言格式及ABI">RISC-V</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Skill/ASM/RISC-V/汇编语言格式及ABI">汇编语言格式及ABI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Skill/ASM/RISC-V/RISC-V简介">RISC-V 简介</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Skill/ASM/RISC-V/通用寄存器和指令">RISC-V 通用寄存器和指令</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Skill/ASM/RISC-V/扩展寄存器和指令">RISC-V 扩展寄存器和指令</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Skill/ASM/RISC-V/流水线&amp;硬件模块&amp;译码模块">流水线 &amp; 硬件模块 &amp; 译码模块</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Skill/ASM/RISC-V/ALU模块&amp;branch模块">ALU 模块和 branch 模块</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Skill/ASM/RISC-V/LOAD&amp;STORE-UNIT">LSU &amp; SRAM &amp; GPIO模块</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Skill/ASM/RISC-V/CSR读写控制">CSR读写控制</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Skill/ASM/RISC-V/EXU模块和CPU运行">EXU模块和CPU运行</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Skill/ASM/RISC-V/RISC-V总线和流水线">RISC-V 总线和流水线</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Skill/ASM/RISC-V/RISC-V定时器及中断">RISC-V 定时器及中断</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Skill/ASM/RISC-V/riscv-asm-manual">RISC-V Assembly Programmer&#x27;s Manual</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Skill/ASM/x86/X86-64汇编">x86</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Skill/Android/Android概述">Android</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Skill/C/基础知识/数据类型">C</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Skill/C++/基础知识/基本数据类型">C++</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Skill/Golang/基础知识/条件判断">Golang</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/Skill/LaTeX/">LaTex</a><button aria-label="Toggle the collapsible sidebar category &#x27;LaTex&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Skill/Linux/POSIX">Linux</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/Skill/Markdown/">README</a><button aria-label="Toggle the collapsible sidebar category &#x27;README&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Skill/Mermaid/">mermaid</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Skill/Python/运算符">Python</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Skill/SQL/数据库理论">SQL</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Skill/工具链/工具&amp;网站">工具链</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Skill/常用CLI/docker-CLI">常用CLI</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Skill/设计模式/多态和多态性">设计模式</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">ASM</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">RISC-V</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">流水线 &amp; 硬件模块 &amp; 译码模块</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>流水线 &amp; 硬件模块 &amp; 译码模块</h1><p><a href="https://www.icfedu.cn/?s=RISC-V32%E4%B8%AA%E5%AF%84%E5%AD%98%E5%99%A8%E5%92%8C%E8%AF%91%E7%A0%81%E6%A8%A1%E5%9D%97" target="_blank" rel="noopener noreferrer">来源</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="一cpu经典五级流水线">一、CPU经典五级流水线<a class="hash-link" href="#一cpu经典五级流水线" title="Direct link to heading">​</a></h2><p>经典五级流水线， RISC-V 五级流水线</p><p><strong>在cpu 设计中，经常会使用「流水线设计」， 相对早期的状态机逻辑来说，流水线设计会有效的提高cpu 的效率</strong>。</p><p>使用流水线设计，会在现有的生产工艺下，相同系统主频下提高<strong>cpu的效率，通常我们会使用MIPS 和MIPS/Mhz 等标准来衡量</strong>。</p><p> 其中MIPS 是指 million instruction per second,表示<strong>每秒多少百万条指令</strong>， 例如 5MIPS 是指每秒500万条指令。 这是一个绝对值，取决于流水线设计的有效性， 分支预测， cpu 主频高低等等。</p><p><strong>MIPS/Mhz 表示 CPU 在每 1MHz 的系统时钟下，运行速度下可以执行多少个MIPS</strong>。如 10MIPS/MHz，表示如果 CPU 运行在 1MHz 的频率下，每秒可执行1000万条指令，如果 CPU 运行在 5MHz 的频率下，每秒可执行五千万条指令。这个参数剔除了系统时钟的参数， 这样就和生产工艺无关， 用来评估cpu 的设计性能， 而不是生产工艺性能。</p><p><strong>流水线的级数越多， 每一级流水线的逻辑就越少，那么生产的时候，时钟的主频就会越高</strong>。 缺点是：流水线级数越多，需要的cpu设计资源越多，cpu 设计也会更加复杂，处理流水冲突的成本越高，同时，相对功耗也会增加。因此，cpu 设计多少级流水线，是由产品的定义（定位）来决定的。</p><p>对于一些低功耗，手持，或者移动设备， cpu 设计希望的是待机时间长，产品功耗低， 对于性能不是优先考虑的。这样就可以减少流水线级数，甚至可以使用状态机</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1状态机逻辑">1、状态机逻辑<a class="hash-link" href="#1状态机逻辑" title="Direct link to heading">​</a></h3><p><img loading="lazy" src="/assets/images/74-f0350d6f93e5db1f644a83eb3e554012.jpeg" width="807" height="335" class="img_ev3q"></p><p>举例：</p><p><strong>ADDI x13，x12，5</strong>对应的机器码为0000_0000_0101_01100_000_01101_0010011，对应的16进制为32’h0056_0693</p><p><img loading="lazy" src="/assets/images/75-13f465b6ae7eb71f30d0cf1311e30cb8.jpeg" width="749" height="81" class="img_ev3q"></p><p><img loading="lazy" alt="76" src="/assets/images/76-a3307b840bf155c7942ecb5d1dba9b6c.jpeg" width="1488" height="266" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2流水线逻辑">2、流水线逻辑<a class="hash-link" href="#2流水线逻辑" title="Direct link to heading">​</a></h3><p><strong>在经典的流水线设计中，5级流水线是非常有代表性的。 它主要有：</strong></p><p>1）取指IF,     (instruction fetch)</p><p>2）译码ID，   (instruction decoder)</p><p>3）执行EX，   (execution )</p><p>4）访存MEM，(access memory)</p><p>5）写回WB    (write back)</p><p>5个部分（5级）组成。</p><p><img loading="lazy" src="/assets/images/77-112e394bd4154be984189b42003daa93.jpeg" width="634" height="360" class="img_ev3q"></p><p>cycle 1 : 第1条指令的<strong>取指</strong>。</p><p>cycle 2: 第1条指令的<strong>译码</strong>， 第2条指令<strong>取指</strong>。</p><p>cycle 3 : 第1条指令的<strong>执行</strong>， 第2条指令<strong>译码</strong>， 第3条指令<strong>取指</strong>。</p><p>cycle 4 : 第1条指令的<strong>访存</strong>， 第2条指令<strong>执行</strong>， 第3条指令<strong>译码</strong>， 第4条指令<strong>取指</strong>。</p><p>cycle 5 : 第1条指令的<strong>写回</strong>， 第2条指令<strong>访存</strong>， 第3条指令<strong>执行</strong>， 第4条指令<strong>译码</strong>，第5条指令<strong>取指</strong>。</p><p>cycle 6 : 第6条指令的<strong>取指</strong>， 第2条指令<strong>回写</strong>， 第3条指令<strong>访存</strong>， 第4条指令<strong>执行</strong>，第5条指令<strong>译码</strong>。</p><p>cycle 7 : 第6条指令的<strong>译码</strong>， 第7条指令<strong>取指</strong>， 第3条指令<strong>写回</strong>， 第4条指令<strong>译码</strong>，第5条指令<strong>执行</strong>。</p><p>cycle 8 : 第6条指令的<strong>执行</strong>， 第7条指令<strong>译码</strong>， 第8条指令<strong>取指</strong>， 第4条指令<strong>执行</strong>，第5条指令<strong>访存</strong>。</p><p>cycle 9 : 第6条指令的<strong>访存</strong>， 第7条指令<strong>执行</strong>， 第8条指令<strong>译码</strong>， 第9条指令<strong>访存</strong>，第5条指令<strong>写回</strong>。</p><p>可以看到， 第一个时钟周期内， 只有1条指令操作被执行； 第二个时钟周期内，有2条指令操作被执行；第三个时钟周期内，有3条指令操作被执行；</p><p>第四个时钟周期内，有4条指令操作被执行； 从第五时钟开始， 每个时钟周期，都有5条指令操作被执行。 <strong>这相当于之后的每个时钟周期内，都有一个完整的指令被执行完毕（取指，译码，执行，访存，回写）。这是cpu的效率达到最高值（理想状态）</strong>。 由于cpu 在执行指令时，会遇到跳转， 分支跳转，长周期指令（乘法，除法），长周期访存（flash， ddr等等） 流水线会发生暂停，甚至退出重来等等情况。为了减少暂停，退出情况发生， 各种不同的cpu 都有相应的手段来尽量避免，(哪一个cpu 预测的比较好， cpu 的效率自然就高，但同时也付出资源和功耗为代价）。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="risc-v-5级流水线设计">RISC-V 5级流水线设计<a class="hash-link" href="#risc-v-5级流水线设计" title="Direct link to heading">​</a></h4><p>risc-v 也有经典的5级流水线设计，但也有2级，3级，7级，甚至更多级的流水线设计，这取决于公司对产品的定义，riscv 本身并没有规定一定要使用多少级流水线。</p><p><img loading="lazy" src="/assets/images/78-88f82b33d8547a7586ef58ac4d141ecb.jpeg" width="998" height="694" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="第一级-取指">第一级 取指<a class="hash-link" href="#第一级-取指" title="Direct link to heading">​</a></h4><p><strong>取指主要是控制pc</strong> （program counter）一般情况下，每个时钟周期pc = pc + 4; 同时将指令送给译码模块； 但是如果有BRANCH,JAL,JALR,AUIPC ，将修改pc 为这些指令计算出来的值，并且以计算后的pc 为地址， 读取相应地址的指令， 送给译码模块。</p><p><img loading="lazy" src="/assets/images/79-0f93b8e188f8dcc70cbd78a191b202f9.jpeg" width="1032" height="696" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="第二级-译码">第二级 译码<a class="hash-link" href="#第二级-译码" title="Direct link to heading">​</a></h4><p><strong>译码模块负责从指令中分离出来</strong>：</p><p>1）具体是什么指令（ADDI, AND, JAL, LUI 等等）,</p><p>2）需要 哪些寄存器配合 下一级的执行操作 （rs1, rs2, rd)</p><p>3）load/save 等需要存储器的地址（得到地址中的数据）</p><p><img loading="lazy" src="/assets/images/80-47c7e0190eb42928d03189f7ea1bceb7.jpeg" width="994" height="697" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="第三级-执行">第三级 执行<a class="hash-link" href="#第三级-执行" title="Direct link to heading">​</a></h4><p><strong>根据译码的结果，进行相应的计算</strong>：包括add， xor, or,and, pc 跳转， 分支跳转等等。在变级的流水线（不是固定5级流水线设计中）也可以根据指令直接回写。</p><p><img loading="lazy" src="/assets/images/81-709322e9227e7682e18cae6a4fdd1cec.jpeg" width="1000" height="690" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="第四级-访存">第四级 访存<a class="hash-link" href="#第四级-访存" title="Direct link to heading">​</a></h4><p>load, store 等操作 <strong>访问存储器</strong>，或者是csr 寄存器的访问。</p><p><img loading="lazy" src="/assets/images/82-28344fc854246fc9b259aecede460652.jpeg" width="1008" height="698" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="第五级-回写">第五级 回写<a class="hash-link" href="#第五级-回写" title="Direct link to heading">​</a></h4><p><strong>将最终的结果回写到32个通用的寄存器中</strong>，完成指令周期的操作。</p><p> 流水线可以设计为2级，3级，5级 ，更多级流水线。 但也可以被设计为变级流水线， 根据不同是指令，迅速完成整个指令的操作，从而加快cpu执行速度，</p><p>例如 add x2, x3, x4 没有访存，执行后，就可以直接回写了。</p><p><img loading="lazy" src="/assets/images/83-fd993f7f82f2c0b8278220b5c0346cff.jpeg" width="1026" height="702" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="二cpu硬件模块">二、CPU硬件模块<a class="hash-link" href="#二cpu硬件模块" title="Direct link to heading">​</a></h2><p>RISC-V FPGA 设计中， RISC-V 的核心框架模块组成。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="risc-v-cpu-架构">RISC-V cpu 架构<a class="hash-link" href="#risc-v-cpu-架构" title="Direct link to heading">​</a></h3><p><strong>RISC-V 中cpu 核心设计框架组成结构:</strong></p><p><img loading="lazy" src="/assets/images/84-97e4c350f7e0e00f603aa4bd24d76b71.jpeg" width="712" height="476" class="img_ev3q"></p><p>其中：</p><p><strong>fii_cpu_sys.v</strong> : 工程顶层模块</p><p><strong>fii_iobuf.v</strong> ： GPIO 端口 逻辑 模块</p><p><strong>SYS_DCM</strong>: PLL 时钟模块 IP</p><p><strong>fii_riscv_cpu.v</strong>: RISC -V cpu 模块顶层</p><p><strong>fii_rv32i_core.v</strong> ： 状态机逻辑模块（RISC -V）运行模块</p><p><strong>TDP_RAM_INSTR</strong>：程序存储单元(ITCM)</p><p><strong>rv32I_exu.v</strong>: RISC -V cpu 内核模块</p><p><strong>regfile_l.v</strong>: 32个通用寄存器模块</p><p><strong>instr_dec.v</strong>: 指令译码模块</p><p><strong>exu_alu.v</strong>: 执行模块</p><p><strong>exu_LSU.v</strong>: Load/Store 模块</p><p><strong>fii_UART.v</strong>：UART 模块 </p><p><strong>fii_timer_lsu.v</strong>: Timer 模块</p><p><strong>fii_GPIO.v</strong>: GPIO 模块</p><p><strong>D_sram.v</strong>: SRAM DTCM 模块</p><p><strong>exu_BRANCH.v</strong>：分支处理模块</p><p><strong>exu_csr.v</strong>: CSR 寄存器模块</p><p><img loading="lazy" src="/assets/images/85-d77a5952528914e973e9e2ca206f3746.jpeg" width="1339" height="775" class="img_ev3q"></p><p>在vivado 工程文件中：</p><p><img loading="lazy" src="/assets/images/86-341435ec9329386ffb2df95b7fb86ee8.jpeg" width="375" height="175" class="img_ev3q"></p><p>RISC-V 的核心模块组成：</p><p>regile_l_inst    ：32个通用寄存器</p><p>instr_dec_inst  ：指令译码模块</p><p>exu_alu_u   ： 执行模块</p><p>exu_LSU_u  ：load/store 外设访存模块</p><p>exu_BRANCH_u：条件分支模块</p><p>exu_CSR_U：CSR 寄存器模块</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cpu-架构分类">CPU 架构分类<a class="hash-link" href="#cpu-架构分类" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="冯诺依曼架构">冯诺依曼架构<a class="hash-link" href="#冯诺依曼架构" title="Direct link to heading">​</a></h4><p>冯诺依曼架构：也称做普林斯顿架构(Princeton Architecture)。 其结构特点时数据存储器和程序存储器按照<strong>统一的地址编址</strong>，如32位的地址总线，可寻址4G 的地址空间。程序存储器，数据存储器以及外设等<strong>每部分占有4G空间的一个部分，彼此之间互不重叠</strong>。 </p><p><img loading="lazy" src="/assets/images/87-230cb2013207140e5680f7f4d5957a41.jpeg" width="1020" height="283" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="哈弗架构">哈弗架构<a class="hash-link" href="#哈弗架构" title="Direct link to heading">​</a></h4><p>哈弗架构(Harvard architecture)：哈弗结构不同于冯.诺依曼结构将访问空间线性划分，而是将数据存储器与程序存储器划分为两个独立的寻址空间，自己维护自己的地址空间，最典型的结构莫过于Intel最早推出的8051，16位的地址总线可访问64k空间，但是数据和程序在控制器的协助下，实现数据访问与程序访问的分离，因此访问空间扩大了一倍</p><p><img loading="lazy" src="/assets/images/88-103e12885c2f3c8ae0648b4bc076f692.jpeg" width="907" height="351" class="img_ev3q"></p><hr><p><strong>冯.诺依曼结构与哈弗结构的优缺点：</strong></p><p>冯.诺依曼结构：</p><ul><li><p>优点：整个访问空间是线性的，整个空间采用统一编码，使用同一个程序计数器PC，因此<strong>对控制器的要求比较低，硬件资源（RTL）开销小于哈弗结构</strong>。</p></li><li><p>缺点：<strong>无法扩展空间范围</strong>，同时由于使用统一的空间编码，在遇到资源冲突时必须<strong>等待冲突</strong>解决才能继续程序的运行，因此<strong>效率较低</strong>。</p></li></ul><p>哈弗结构：</p><ul><li><p>优点：由于数据空间与程序空间分离，一次整个访问空间几乎扩大一倍，<strong>不存在程序空间的访问与数据空间访问的冲突</strong></p></li><li><p>缺点：<strong>控制器复杂</strong>，需要两套PC计数器，硬件开销大</p></li></ul><p>现在的cpu 设计中， 已经不是像早期的cpu 设计那样泾渭分明了， 可能一个cpu 即支持 普林斯顿架构，同时支持哈弗架构。 根据程序，数据的不同， cpu 可以从不同的区域将数据读出，或者写入。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="fii-risc-v-架构">FII-RISC-V 架构<a class="hash-link" href="#fii-risc-v-架构" title="Direct link to heading">​</a></h4><p>目前的fii-riscv v2.01 版本CPU，支持普林斯顿架构， 同时也支持哈弗架构。当然，哈弗架构在执行效率上还是比较高的，绝大部分应用使用的时哈弗架构。但为展示普林斯顿架构的结构，同时在之后的版本会支持JTAG 模块， JTAG 模块使用的也是普林斯顿架构，这种方式。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="三寄存器文件">三、寄存器文件<a class="hash-link" href="#三寄存器文件" title="Direct link to heading">​</a></h2><p>在RISC-V RV32I CPU 核中，需要32个通用的寄存器。这些寄存器是解析riscv 汇编指令的关键部分。</p><p><img loading="lazy" src="/assets/images/90-69959458056588fea57b7ae0b2190438.jpeg" width="699" height="532" class="img_ev3q"></p><p><img loading="lazy" src="/assets/images/91-50826a4c38a58d764fc180d12e5beb25.jpeg" width="1334" height="775" class="img_ev3q"></p><p><strong>每一个RV32I 的risc-v 的cpu 中，都有32个通用的寄存器</strong>。 其中X0寄存器 在读取时，永远为‘0’。 写x0 寄存器 时，cpu 硬件可以进行忽略（不做任何处理）。对于RV32E cpu 来说， 可以省略掉x16-x31 这16个通用寄存器，只是保留x0-x15 这16个寄存器，这样的设计可以减少cpu 的尺寸，但并不是非常通用。因为即使是rv32I 的cpu 尺寸也不是很大。</p><p><img loading="lazy" src="/assets/images/89-e82adf978bb0f5dbca58b4bd937f4e5d.jpeg" width="736" height="664" class="img_ev3q"></p><p>XLEN 是根据riscv 的 设计可以有所不同，对于RV64 来说， XLEN = 64; 对于RV32 来说，XLEN = 32。 我们当前设计的riscv cpu 为RV32I， 所以XLEN = 32。</p><div class="language-verilog codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-verilog codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">module regfile_I(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">input sys_clk,              // 系统时钟</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">input i_EXE_vld,            // 执行enable 信号</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">input [ 4: 0 ] i_rs1_idx,   // 汇编指令中的rs1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">input [ 4: 0 ] i_rs2_idx,   // 汇编指令中的rs2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output [ 31: 0 ] o_rs1_val, // 汇编指令中的rs1,所对应的32个通用寄存器当中选中的寄存器的值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output [ 31: 0 ] o_rs2_val, // 汇编指令中的rs2,所对应的32个通用寄存器当中选中的寄存器的值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output o_wb_rdy,            // 回写准备好，一直 等于 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">input i_wb_wen,             // 写通用寄存器 信号</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">input [ 4: 0 ] i_wb_rd_idx, // 汇编指令中的rd,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">input [ 31: 0 ] i_wb_val    // 汇编指令中的rd,所对应的32个通用寄存器当中选中的寄存器的值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire [ 31: 0 ] rf_r [ 31: 1 ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire [ 31: 1 ] rf_wen;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">genvar i;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">generate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for ( i = 1; i &lt; 32; i = i + 1 )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">begin : REG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    assign rf_wen[ i ] = i_EXE_vld &amp; i_wb_wen &amp; ( i_wb_rd_idx == i ) ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fii_dffl #( 32 ) rf_dffl ( rf_wen[ i ], i_wb_val, rf_r[ i ], sys_clk );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">endgenerate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">`ifdef sim</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    assign o_rs1_val = ( i_rs1_idx == 0 ) ? 32&#x27;b0 :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ( rf_r[ i_rs1_idx ] == 32&#x27;hxxxxxxxx ) ? 32&#x27;b0 : rf_r[ i_rs1_idx ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    assign o_rs2_val = ( i_rs2_idx == 0 ) ? 32&#x27;b0 :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ( rf_r[ i_rs2_idx ] == 32&#x27;hxxxxxxxx ) ? 32&#x27;b0 : rf_r[ i_rs2_idx ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">`else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    assign o_rs1_val = ( i_rs1_idx == 0 ) ? 32&#x27;b0 : rf_r[ i_rs1_idx ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    assign o_rs2_val = ( i_rs2_idx == 0 ) ? 32&#x27;b0 : rf_r[ i_rs2_idx ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">`endif</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_wb_rdy = 1&#x27;b1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">endmodule</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>input <!-- -->[ 4: 0 ]<!-- --> i_rs1_idx, // 汇编指令中的rs1</p><p>input <!-- -->[ 4: 0 ]<!-- --> i_rs2_idx, // 汇编指令中的rs2</p><p>output <!-- -->[ 31: 0 ]<!-- --> o_rs1_val, // 汇编指令中的rs1,所对应的32个通用寄存器当中选中的寄存器的值</p><p>output <!-- -->[ 31: 0 ]<!-- --> o_rs2_val, // 汇编指令中的rs2,所对应的32个通用寄存器当中选中的寄存器的值</p><p>output o_wb_rdy, // 回写准备好，一直 等于 1</p><p>input i_wb_wen, // 写通用寄存器 信号</p><p>input <!-- -->[ 4: 0 ]<!-- --> i_wb_rd_idx,// 汇编指令中的rd,</p><p>input <!-- -->[ 31: 0 ]<!-- --> i_wb_val // 汇编指令中的rd,所对应的32个通用寄存器当中选中的寄存器的值</p><p>在代码段中：<strong>写操作</strong></p><div class="language-verilog codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-verilog codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">genvar i;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">generate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for ( i = 1; i &lt; 32; i = i + 1 )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        begin : REG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            assign rf_wen[ i ] = i_EXE_vld &amp; i_wb_wen &amp; ( i_wb_rd_idx == i ) ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fii_dffl #( 32 ) rf_dffl ( rf_wen[ i ], i_wb_val, rf_r[ i ], sys_clk );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">endgenerate</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>fii_dffl 文件代码：</p><div class="language-verilog codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-verilog codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">module fii_dffl # (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">parameter DW = 32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">) (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    input ld,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    input [DW-1:0] din,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    output reg [DW-1:0] q = 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    input clk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">always @(posedge clk )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (ld)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     q &lt;= #1 din;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">endmodule</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>在代码段中：<strong>读操作</strong></p><p>在读取x0时（不论是rs1，还是rs2 读取x0）， 直接返回0； 其他情况（1-31） 根据寄存器当中的值进行返回。</p><div class="language-verilog codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-verilog codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">assign o_rs1_val = ( i_rs1_idx == 0 ) ? 32’b0 : rf_r[ i_rs1_idx ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_rs2_val = ( i_rs2_idx == 0 ) ? 32’b0 : rf_r[ i_rs2_idx ];</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="四指令译码器">四、指令译码器<a class="hash-link" href="#四指令译码器" title="Direct link to heading">​</a></h2><p>RISC-V FPGA 设计中， RISC-V 的核心模块包括指令译码模块。 这个模块的主要功能是：根据当前的PC，对ITCM 输入的机器码进行解析。包括得到相应的汇编语言命令，需要的rs1，rs2寄存器，需要存储的rd 寄存器等</p><p><img loading="lazy" src="/assets/images/92-ceebe67179ed64e2df505a8f8ca68f34.jpeg" width="705" height="485" class="img_ev3q"></p><p><img loading="lazy" src="/assets/images/93-1696daec5a1e34198a8248276b96de1f.jpeg" width="1372" height="771" class="img_ev3q"></p><p>在vivado 工程文件中：</p><p>instr_dec 模块 输入为汇编语言的机器码， 输出为：</p><p>RS1_IDX: 通用寄存器rs1 索引</p><p>RS2_IDX: 通用寄存器rs2 索引</p><p>RD_IDX:  通用寄存器RD 索引</p><p>instr_group: 包括：OP_IMM, OP, LUI, AUIPC, JAL, JALR, BRANCH, LOAD, STORE, CSR, 等等</p><p>opimm_instr: 包括：SRAI, SRLI, SLLI, ANDI, ORI, XORI, SLTIU, SLTI, ADDI</p><p>op_instr: 包括：SRA, SUB, SRL, SLL, XOR, OR, AND, SLTU, SLT, ADD</p><p>branch_instr: 包括：BGTU, BGT, BLTU, BLT, BNE, BEQ</p><p>shamt: 数据位移宽度 I_imm: I-type 立即数</p><p>S_imm: S-type 立即数</p><p>J_imm: J-type 立即数</p><p>U_imm: U-type 立即数</p><p>B_imm: B-type 立即数</p><p>load_instr: 包括：LBU, LB, LHU, LH, LW</p><p>store_instr: 包括：SB, SH, SW</p><p>csr_instr: 包括：CSRRCI, CSRRSI, CSRRWI, CSRRC, CSRRS, CSRRW</p><p>csr_addr: 选择4096 个csr 寄存器中的一个 CSR_imm: csr 立即数  </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="decoder-模块代码">decoder 模块代码<a class="hash-link" href="#decoder-模块代码" title="Direct link to heading">​</a></h3><div class="language-verilog codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-verilog codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">module instr_dec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">input sys_clk,                  // 系统时钟</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">input [ 31: 0 ] i_instr,        // 从ITCM 中读取的汇编语言机器码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output RV32I,                   // 译码输出的RV32I 格式. 目前，我们不支持RV32C, RV64等</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output [ 4: 0 ] o_rs1_idx,      // 汇编指令中rs1 所指定的32个通用寄存器中的一个</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output [ 4: 0 ] o_rs2_idx,      // 汇编指令中rs2 所指定的32个通用寄存器中的一个</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output [ 4: 0 ] o_rd_idx,       // 汇编指令中rd 所指定的32个通用寄存器中的一个</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output [ 15: 0 ] o_instr_group, // 指令组，将LOAD,STORE,CSR,BRANCH,OP,OP_imm 等等 指令分组</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output [ 8: 0 ] o_opimm_instr,  // opimm 指令中的每一条指令，包括：SRAI, SRLI, SLLI, ANDI, ORI, XORI, SLTIU, SLTI, ADDI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output [ 9: 0 ] o_op_instr,     // op 指令中的每一条指令，包括：SRA, SUB, SRL, SLL, XOR, OR, AND, SLTU, SLT, ADD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output [ 5: 0 ] o_branch_instr, // branch 指令中的每一条指令，包括：BGTU, BGT, BLTU, BLT, BNE, BEQ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output [ 4: 0 ] o_load_instr,   // load 指令中的每一条指令，包括：LBU, LB, LHU, LH, LW</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output [ 2: 0 ] o_store_instr,  // store 指令中的每一条指令，包括：SB, SH, SW</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output [ 1: 0 ] o_fence_instr,  // fence 指令中的每一条指令，包括：fence， fence.i</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output [ 5: 0 ] o_csr_instr,    // CSR 指令中的每一条指令，包括：SCRRCI, CSRRSI, CSRRWI, SCRRC, CSRRS, CSRRW</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output [11: 0 ] o_csr_addr,     // 选择4095 个csr 寄存器中的一个 CSR_imm: csr 立即数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output [ 4: 0 ] o_shamt,        // 数据位移宽度 I_imm: I-type 立即数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output [ 31: 0 ] o_I_imm,       // I-type immediate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output [ 31: 0 ] o_S_imm,       // R-type immediate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output [ 31: 0 ] o_B_imm,       // S-type immediate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output [ 31: 0 ] o_J_imm,       // J-type immediate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output [ 31: 0 ] o_U_imm,       // U-type immediate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output [ 31: 0 ] o_csr_imm,     // CSR 立即数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//output [31:0] o_pc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output o_mret,                  // 中断返回</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output o_ecall,                 // 通过引发环境调用异常来请求执行环境</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output o_ebreak,                // 调试中断断点</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output o_dret,                  // 调试中断 返回</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output o_wfi                    // 等待中断</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//===============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// riscv instruction basic decode OP DECODE </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire [ 6: 0 ] opcode = i_instr[ 6: 0 ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire [ 2: 0 ] funct3 = i_instr[ 14: 12 ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire [ 6: 0 ] funct7 = i_instr[ 31: 25 ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign RV32I = ( opcode[ 1: 0 ] == 2&#x27;b11 ) &amp;&amp; ( opcode[ 4: 2 ] != 3&#x27;b111 );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//register index decode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_rd_idx = i_instr[ 11: 7 ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_rs1_idx = i_instr[ 19: 15 ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_rs2_idx = i_instr[ 24: 20 ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//===============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// decode opcode [6:0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire LUI    = ( opcode[ 6: 0 ] == 7&#x27;b011_0111 ); // TYPE U lui</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire AUIPC  = ( opcode[ 6: 0 ] == 7&#x27;b001_0111 ); // TYPE U auipc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire JAL    = ( opcode[ 6: 0 ] == 7&#x27;b110_1111 ); // TYPE J jal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire JALR   = ( opcode[ 6: 0 ] == 7&#x27;b110_0111 ); // TYPE I jalr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire BRANCH = ( opcode[ 6: 0 ] == 7&#x27;b110_0011 ); // TYPE B</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire LOAD   = ( opcode[ 6: 0 ] == 7&#x27;b000_0011 ); // TYPE I load</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire STORE  = ( opcode[ 6: 0 ] == 7&#x27;b010_0011 ); // YTPE S store</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire OP_IMM = ( opcode[ 6: 0 ] == 7&#x27;b001_0011 ); // TYPE I operator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire OP     = ( opcode[ 6: 0 ] == 7&#x27;b011_0011 ); // TYPE R operator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire FENCE  = ( opcode[ 6: 0 ] == 7&#x27;b000_1111 ); // TYPE I fence</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire CSR    = ( opcode[ 6: 0 ] == 7&#x27;b111_0011 ); // TYPE I csr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_instr_group = { FENCE, CSR, STORE, LOAD, BRANCH, JALR, JAL, AUIPC, LUI, OP, OP_IMM };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//===============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// funct3 decode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire funct3_0 = ( funct3 == 3&#x27;b000 );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire funct3_1 = ( funct3 == 3&#x27;b001 );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire funct3_2 = ( funct3 == 3&#x27;b010 );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire funct3_3 = ( funct3 == 3&#x27;b011 );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire funct3_4 = ( funct3 == 3&#x27;b100 );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire funct3_5 = ( funct3 == 3&#x27;b101 );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire funct3_6 = ( funct3 == 3&#x27;b110 );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire funct3_7 = ( funct3 == 3&#x27;b111 );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//===============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//funct7 decode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire funct7_0 = ( funct7 == 7&#x27;b0 );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire funct7_20 = ( funct7 == 7&#x27;b010_0000 );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//===============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//imm &amp; shamt decode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_I_imm = { { 20{ i_instr[ 31 ] } } , i_instr[ 31: 20 ] }; //addi/slti/sltiu/andi/ori/xori, lw/lh/lhu/lb/lbu, JALR, SLLI/SRLi/SRAI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_S_imm = { { 20{ i_instr[ 31 ] } }, i_instr[ 31: 25 ], i_instr[ 11: 7 ] }; //s-type instruction, provide imm or store instruction</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_B_imm = { { 19{ i_instr[ 31 ] } }, i_instr[ 31 ], i_instr[ 7 ], i_instr[ 30: 25 ], i_instr[ 11: 8 ], 1&#x27;b0 };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_U_imm = { i_instr[ 31: 12 ], 12&#x27;b0 };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_J_imm = { { 11{ i_instr[ 31 ] } }, i_instr[ 31 ], i_instr[ 19: 12 ], i_instr[ 20 ], i_instr[ 30: 21 ], 1&#x27;b0 }; //for JAL,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_shamt = i_instr[ 24: 20 ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_csr_imm = {27&#x27;b0,i_instr[19:15]};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//===============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// instruction decode for I-type operator 7&#x27;b001_0011</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_addi  = OP_IMM &amp; funct3_0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_slti  = OP_IMM &amp; funct3_2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_sltiu = OP_IMM &amp; funct3_3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_xori  = OP_IMM &amp; funct3_4;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_ori   = OP_IMM &amp; funct3_6;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_andi  = OP_IMM &amp; funct3_7;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_slli = OP_IMM &amp; funct3_1 ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_srli = OP_IMM &amp; funct3_5 &amp; funct7_0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_srai = OP_IMM &amp; funct3_5 &amp; funct7_20;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_opimm_instr = { rv32i_srai, rv32i_srli, rv32i_slli,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rv32i_andi, rv32i_ori, rv32i_xori,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rv32i_sltiu, rv32i_slti, rv32i_addi };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//===============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//instruction decode for R-type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_add  = OP &amp; funct3_0 &amp; funct7_0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_sub  = OP &amp; funct3_0 &amp; funct7_20;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_sll  = OP &amp; funct3_1 &amp; funct7_0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_slt  = OP &amp; funct3_2 &amp; funct7_0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_sltu = OP &amp; funct3_3 &amp; funct7_0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_xor  = OP &amp; funct3_4 &amp; funct7_0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_srl  = OP &amp; funct3_5 &amp; funct7_0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_sra  = OP &amp; funct3_5 &amp; funct7_20;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_or   = OP &amp; funct3_6 &amp; funct7_0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_and  = OP &amp; funct3_7 &amp; funct7_0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_op_instr = { rv32i_sra, rv32i_sub, rv32i_srl,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rv32i_sll, rv32i_xor, rv32i_or,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rv32i_and, rv32i_sltu, rv32i_slt,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rv32i_add };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//===============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//instruction for conditional branch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_beq  = BRANCH &amp; funct3_0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_bne  = BRANCH &amp; funct3_1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_blt  = BRANCH &amp; funct3_4;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_bltu = BRANCH &amp; funct3_6;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_bgt  = BRANCH &amp; funct3_5;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_bgtu = BRANCH &amp; funct3_7;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_branch_instr = { rv32i_bgtu, rv32i_bgt, rv32i_bltu,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rv32i_blt, rv32i_bne, rv32i_beq };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//===============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// memory operation load/store</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_lw  = LOAD &amp; funct3_2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_lh  = LOAD &amp; funct3_1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_lhu = LOAD &amp; funct3_5;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_lb  = LOAD &amp; funct3_0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_lbu = LOAD &amp; funct3_4;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_sw = STORE &amp; funct3_2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_sh = STORE &amp; funct3_1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_sb = STORE &amp; funct3_0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_load_instr  = { rv32i_lbu, rv32i_lb, rv32i_lhu, rv32i_lh, rv32i_lw };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_store_instr = { rv32i_sb, rv32i_sh, rv32i_sw };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//===============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//instruction for fence</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_fence   = FENCE &amp; funct3_0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_fence_i = FENCE &amp; funct3_1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_fence_instr = {rv32i_fence_i, rv32i_fence };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//===============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//instruction for csr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_csrrw  = CSR &amp; funct3_1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_csrrs  = CSR &amp; funct3_2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_csrrc  = CSR &amp; funct3_3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_csrrwi = CSR &amp; funct3_5;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_csrrsi = CSR &amp; funct3_6;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire rv32i_csrrci = CSR &amp; funct3_7;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_csr_instr = { rv32i_csrrci, rv32i_csrrsi, rv32i_csrrwi, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rv32i_csrrc, rv32i_csrrs, rv32i_csrrw};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_csr_addr = i_instr[ 31: 20 ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//===============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// System Instructions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_ecall  = CSR &amp; funct3_0 &amp; (i_instr[31:20] == 12&#x27;b0000_0000_0000);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_ebreak = CSR &amp; funct3_0 &amp; (i_instr[31:20] == 12&#x27;b0000_0000_0001);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_mret   = CSR &amp; funct3_0 &amp; (i_instr[31:20] == 12&#x27;b0011_0000_0010);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_dret   = CSR &amp; funct3_0 &amp; (i_instr[31:20] == 12&#x27;b0111_1011_0010);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_wfi    = CSR &amp; funct3_0 &amp; (i_instr[31:20] == 12&#x27;b0001_0000_0101);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">endmodule</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>1）查找汇编指令机器码最低7位，得到opcode：</p><div class="language-verilog codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-verilog codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wire [ 6: 0 ] opcode = i_instr[ 6: 0 ]; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign RV32I = ( opcode[ 1: 0 ] == 2&#x27;b11 ) &amp;&amp; ( opcode[ 4: 2 ] != 3&#x27;b111 );</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如果opcode 最低2位为 11， 并且最低5位 不能是 111111 ， 那么当前指令为32位长度的指令。</p><div class="language-verilog codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-verilog codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wire LUI           = ( opcode[ 6: 0 ] == 7’b011_0111 );   // TYPE U lui</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire AUIPC     = ( opcode[ 6: 0 ] == 7’b001_0111 );   // TYPE U auipc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire JAL           = ( opcode[ 6: 0 ] == 7’b110_1111 );   // TYPE J jal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire JALR        = ( opcode[ 6: 0 ] == 7’b110_0111 );   // TYPE I jalr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire BRANCH = ( opcode[ 6: 0 ] == 7’b110_0011 );  // TYPE B</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire LOAD       = ( opcode[ 6: 0 ] == 7’b000_0011 );  // TYPE I load</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire STORE    = ( opcode[ 6: 0 ] == 7’b010_0011 );   // YTPE S store</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire OP_IMM = ( opcode[ 6: 0 ] == 7’b001_0011 );  // TYPE I operator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire OP             = ( opcode[ 6: 0 ] == 7’b011_0011 );   // TYPE R operator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire FENCE     = ( opcode[ 6: 0 ] == 7’b000_1111 );  // TYPE I fence</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire CSR           = ( opcode[ 6: 0 ] == 7’b111_0011 );   // TYPE I csr</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如果是RV32I 指令， 先译码出是哪一类指令。</p><p>2）将funct3，funct7 译码出来， funct3 主要用来指定当前类中具体哪一条汇编指令； funct7 是当funct3 不够用时的一种补充，比如：某一类指令中有9条指令，但funct3 最多只能指定8条指令。  </p><div class="language-verilog codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-verilog codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wire [ 2: 0 ] funct3 = i_instr[ 14: 12 ]; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wire [ 6: 0 ] funct7 = i_instr[ 31: 25 ]; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_rd_idx = i_instr[ 11: 7 ]; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_rs1_idx = i_instr[ 19: 15 ]; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_rs2_idx = i_instr[ 24: 20 ];</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>3） 拼接 不同指令中的立即数， 根据汇编指令， cpu 这里做的是相对应的解码</p><div class="language-verilog codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-verilog codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">assign o_I_imm = { { 20{ i_instr[ 31 ] } } , i_instr[ 31: 20 ] }; //addi/slti/sltiu/andi/ori/xori, lw/lh/lhu/lb/lbu, JALR, SLLI/SRLi/SRAI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_S_imm = { { 20{ i_instr[ 31 ] } }, i_instr[ 31: 25 ], i_instr[ 11: 7 ] }; //s-type instruction, provide imm or store instruction</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_B_imm = { { 19{ i_instr[ 31 ] } }, i_instr[ 31 ], i_instr[ 7 ], i_instr[ 30: 25 ], i_instr[ 11: 8 ], 1’b0 };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_U_imm = { i_instr[ 31: 12 ], 12’b0 };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_J_imm = { { 11{ i_instr[ 31 ] } }, i_instr[ 31 ], i_instr[ 19: 12 ], i_instr[ 20 ], i_instr[ 30: 21 ], 1’b0 }; //for JAL,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_shamt = i_instr[ 24: 20 ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assign o_csr_imm = {27’b0,i_instr[19:15]};</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>4）确定最终指令</p><p>根据opcode 译码出来的大类， funct3，funct7 译码出来的具体指令， 最终确定当前的机器码是指令集当中的哪一条指令。</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Skill/ASM/RISC-V/扩展寄存器和指令"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">RISC-V 扩展寄存器和指令</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Skill/ASM/RISC-V/ALU模块&amp;branch模块"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">ALU 模块和 branch 模块</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#一cpu经典五级流水线" class="table-of-contents__link toc-highlight">一、CPU经典五级流水线</a><ul><li><a href="#1状态机逻辑" class="table-of-contents__link toc-highlight">1、状态机逻辑</a></li><li><a href="#2流水线逻辑" class="table-of-contents__link toc-highlight">2、流水线逻辑</a></li></ul></li><li><a href="#二cpu硬件模块" class="table-of-contents__link toc-highlight">二、CPU硬件模块</a><ul><li><a href="#risc-v-cpu-架构" class="table-of-contents__link toc-highlight">RISC-V cpu 架构</a></li><li><a href="#cpu-架构分类" class="table-of-contents__link toc-highlight">CPU 架构分类</a></li></ul></li><li><a href="#三寄存器文件" class="table-of-contents__link toc-highlight">三、寄存器文件</a></li><li><a href="#四指令译码器" class="table-of-contents__link toc-highlight">四、指令译码器</a><ul><li><a href="#decoder-模块代码" class="table-of-contents__link toc-highlight">decoder 模块代码</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Doongz Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.958a4673.js"></script>
<script src="/assets/js/main.715bfe53.js"></script>
</body>
</html>